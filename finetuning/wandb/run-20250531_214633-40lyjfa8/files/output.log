INFO:__main__:Starting complete PPO training with 31 batches per epoch
INFO:__main__:Dataset size: 374 samples
INFO:__main__:Batch size: 12
INFO:__main__:PPO epochs per step: 2
INFO:__main__:Learning rate: 3e-06
INFO:__main__:Total samples per epoch: 372
INFO:__main__:Starting epoch 1/2
Epoch 1/2:   0%|                                                                                                  | 0/31 [00:00<?, ?batch/s]/home/yuexi/miniconda3/envs/codegeneration/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:838: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
Epoch 1/2:   3%| | 1/31 [02:33<1:16:40, 153.36s/batch, Reward=0.508, Success=1.00, Pass@1=0.33, TestPass=0.25, KL=-0.000, PolicyLoss=-6.823,/home/yuexi/miniconda3/envs/codegeneration/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:838: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
Epoch 1/2:   6%| | 2/31 [05:59<1:29:09, 184.45s/batch, Reward=0.534, Success=0.83, Pass@1=0.42, TestPass=0.35, KL=0.000, PolicyLoss=-7.054, /home/yuexi/miniconda3/envs/codegeneration/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:838: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
Epoch 1/2:  10%| | 3/31 [08:56<1:24:30, 181.10s/batch, Reward=0.442, Success=0.92, Pass@1=0.25, TestPass=0.26, KL=0.000, PolicyLoss=-5.864, /home/yuexi/miniconda3/envs/codegeneration/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:838: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
Epoch 1/2:  13%|▏| 4/31 [11:27<1:16:02, 168.98s/batch, Reward=0.527, Success=0.92, Pass@1=0.33, TestPass=0.32, KL=0.000, PolicyLoss=-7.045, /home/yuexi/miniconda3/envs/codegeneration/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:838: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
Epoch 1/2:  13%|▏| 4/31 [14:48<1:16:02, 168.98s/batch, Reward=0.549, Success=0.92, Pass@1=0.42, TestPass=0.30, KL=0.000, PolicyLoss=-7.437, INFO:__main__:Step 5: {'rewards/mean': 0.5488854278753205, 'rewards/max': 1.0999976120645443, 'rewards/min': -0.10000451033156424, 'success_rate': 0.9166666666666666, 'test_pass_rate': 0.30434782608695654, 'avg_test_ratio': 0.5151515151515151, 'avg_quality_score': 0.9272727272727274, 'pass_at_1': 0.4166666666666667, 'syntax_errors': 1, 'total_tests': 23, 'passed_tests': 7, 'avg_kl_divergence': 2.3073423790265224e-05, 'avg_base_reward': 0.548888888888889, 'policy_loss': -7.4372113682329655, 'value_loss': 6.441704066004604, 'entropy_loss': -0.1999607142060995, 'ppo_epochs': 2, 'update_count': 24, 'update_skipped': False}
Epoch 1/2:  16%|▏| 5/31 [14:48<1:18:21, 180.82s/batch, Reward=0.549, Success=0.92, Pass@1=0.42, TestPass=0.30, KL=0.000, PolicyLoss=-7.437, /home/yuexi/miniconda3/envs/codegeneration/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:838: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
Epoch 1/2:  19%|▏| 6/31 [17:37<1:13:34, 176.58s/batch, Reward=0.499, Success=0.92, Pass@1=0.33, TestPass=0.28, KL=0.000, PolicyLoss=-6.625, /home/yuexi/miniconda3/envs/codegeneration/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:838: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
Epoch 1/2:  23%|▏| 7/31 [19:42<1:03:55, 159.79s/batch, Reward=0.792, Success=1.00, Pass@1=0.58, TestPass=0.50, KL=0.000, PolicyLoss=-10.710,/home/yuexi/miniconda3/envs/codegeneration/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:838: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
Epoch 1/2:  26%|▎| 8/31 [23:16<1:07:53, 177.12s/batch, Reward=0.609, Success=0.92, Pass@1=0.50, TestPass=0.33, KL=0.000, PolicyLoss=-8.312, /home/yuexi/miniconda3/envs/codegeneration/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:838: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
Epoch 1/2:  29%|▎| 9/31 [26:14<1:04:59, 177.24s/batch, Reward=0.623, Success=1.00, Pass@1=0.42, TestPass=0.35, KL=0.000, PolicyLoss=-8.468, /home/yuexi/miniconda3/envs/codegeneration/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:838: UserWarning: torch.utils.checkpoint: the use_reentrant parameter should be passed explicitly. In version 2.5 we will raise an exception if use_reentrant is not passed. use_reentrant=False is recommended, but if you need to preserve the current default behavior, you can pass use_reentrant=True. Refer to docs for more details on the differences between the two variants.
  return fn(*args, **kwargs)
Epoch 1/2:  29%|▎| 9/31 [28:36<1:04:59, 177.24s/batch, Reward=0.656, Success=1.00, Pass@1=0.50, TestPass=0.33, KL=0.000, PolicyLoss=-9.020, INFO:__main__:Step 10: {'rewards/mean': 0.6555328523157086, 'rewards/max': 1.0999838135845494, 'rewards/min': 0.09996507112955443, 'success_rate': 1.0, 'test_pass_rate': 0.3333333333333333, 'avg_test_ratio': 0.5555555555555555, 'avg_quality_score': 1.0, 'pass_at_1': 0.5, 'syntax_errors': 0, 'total_tests': 24, 'passed_tests': 8, 'avg_kl_divergence': 0.00015135493231355213, 'avg_base_reward': 0.6555555555555554, 'policy_loss': -9.019503995776176, 'value_loss': 7.897358879446983, 'entropy_loss': -0.21959977596998215, 'ppo_epochs': 2, 'update_count': 24, 'update_skipped': False}
Epoch 1/2:  32%|▎| 10/31 [28:36<58:16, 166.49s/batch, Reward=0.656, Success=1.00, Pass@1=0.50, TestPass=0.33, KL=0.000, PolicyLoss=-9.020, V
